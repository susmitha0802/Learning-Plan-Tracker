
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>server: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">lpt/pkg/server/courses.go (100.0%)</option>
				
				<option value="file1">lpt/pkg/server/mentee.go (100.0%)</option>
				
				<option value="file2">lpt/pkg/server/mentor.go (100.0%)</option>
				
				<option value="file3">lpt/pkg/server/users.go (100.0%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package server

import (
        "context"
        "log"
        "lpt/pkg/models"
        pb "lpt/pkg/proto"
)

func (s *LearningPlanTrackerServer) AddCourse(ctx context.Context, req *pb.AddCourseRequest) (*pb.AddCourseResponse, error) <span class="cov8" title="1">{
        c := models.Course{
                Name:    req.Cd.GetName(),
                Caption: req.Cd.GetCaption(),
                Logo:    req.Cd.GetLogo(),
                Time:    req.Cd.GetTime(),
        }

        log.Println("Create course request received")

        id, err := s.DB.AddCourse(c)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">response := pb.CourseDetails{Id: id, Name: c.Name, Caption: c.Caption, Logo: c.Logo, Time: c.Time}
        return &amp;pb.AddCourseResponse{
                Cd: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) AddTopic(ctx context.Context, req *pb.AddTopicRequest) (*pb.AddTopicResponse, error) <span class="cov8" title="1">{
        t := models.Topic{
                Name:     req.Td.GetName(),
                Resource: req.Td.GetResource(),
                CourseId: req.Td.GetCourseId(),
        }

        log.Println("Create topic request received")

        id, err := s.DB.AddTopic(t)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">response := pb.TopicDetails{Id: id, Name: t.Name, Resource: t.Resource, CourseId: t.CourseId}
        return &amp;pb.AddTopicResponse{
                Td: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) AddExercise(ctx context.Context, req *pb.AddExerciseRequest) (*pb.AddExerciseResponse, error) <span class="cov8" title="1">{
        e := models.Exercise{
                Question: req.Ed.GetQuestion(),
                TopicId:  req.Ed.GetTopicId(),
        }

        log.Println("Create exercise request received")

        id, err := s.DB.AddExercise(e)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">response := pb.ExerciseDetails{Id: id, Question: e.Question, TopicId: e.TopicId}
        return &amp;pb.AddExerciseResponse{
                Ed: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) ListCourses(ctx context.Context, req *pb.ListCoursesRequest) (*pb.ListCoursesResponse, error) <span class="cov8" title="1">{

        log.Println("Read courses request received")

        s.DB.ListCourses()

        return &amp;pb.ListCoursesResponse{}, nil
}</span>
</pre>
		
		<pre class="file" id="file1" style="display: none">package server

import (
        "context"
        "errors"
        "fmt"
        "log"
        "lpt/pkg/alerts"
        "lpt/pkg/models"
        pb "lpt/pkg/proto"
)

func (s *LearningPlanTrackerServer) ListAssignedCourses(ctx context.Context, req *pb.ListAssignedCoursesRequest) (*pb.ListAssignedCoursesResponse, error) <span class="cov8" title="1">{

        log.Println("Get assigned course id request received")

        userEmail := req.GetEmail()

        res, err := s.DB.ListAssignedCourses(userEmail)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">return &amp;pb.ListAssignedCoursesResponse{
                CourseId: res,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) GetAssignedCourseDetailsByCourseId(ctx context.Context, req *pb.GetAssignedCourseDetailsByCourseIdRequest) (*pb.GetAssignedCourseDetailsByCourseIdResponse, error) <span class="cov8" title="1">{

        log.Println("Get assigned course id request received")

        course_id := req.GetCourseId()

        res, err := s.DB.GetAssignedCourseDetailsByCourseId(course_id)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">td := []*pb.TopicDetails{}

        for _, topic := range res.Topic </span><span class="cov8" title="1">{

                ed := []*pb.ExerciseDetails{}

                for _, exercise := range topic.Exercise </span><span class="cov8" title="1">{
                        ed = append(ed, &amp;pb.ExerciseDetails{
                                Id:       int32(exercise.ID),
                                Question: exercise.Question,
                        })
                }</span>

                <span class="cov8" title="1">td = append(td, &amp;pb.TopicDetails{
                        Id:       int32(topic.ID),
                        Name:     topic.Name,
                        Resource: topic.Resource,
                        ED:       ed,
                })</span>
        }

        <span class="cov8" title="1">cd := pb.CourseDetails{
                Id:      int32(res.ID),
                Name:    res.Name,
                Caption: res.Caption,
                Logo:    res.Logo,
                Time:    res.Time,
                TD:      td,
        }

        return &amp;pb.GetAssignedCourseDetailsByCourseIdResponse{
                Cd: &amp;cd,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) GetAssignedCourseAndMentorDetails(ctx context.Context, req *pb.GetAssignedCourseAndMentorDetailsRequest) (*pb.GetAssignedCourseAndMentorDetailsResponse, error) <span class="cov8" title="1">{

        log.Println("Get assigned course and mentor details request received")

        courseId := req.GetCourseId()
        menteeEmail := req.GetMenteeEmail()

        mentor, err := s.DB.GetAssignedMentorDetails(courseId, menteeEmail)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">if mentor == nil </span><span class="cov8" title="1">{
                log.Println("Assignment not found")
                return nil, errors.New("Assignment not found")
        }</span>

        <span class="cov8" title="1">courseDetails, err := s.DB.GetAssignedCourseDetailsByCourseId(courseId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">td := []*pb.TopicDetails{}

        for _, topic := range courseDetails.Topic </span><span class="cov8" title="1">{

                ed := []*pb.ExerciseDetails{}

                for _, exercise := range topic.Exercise </span><span class="cov8" title="1">{
                        ed = append(ed, &amp;pb.ExerciseDetails{
                                Id:       int32(exercise.ID),
                                Question: exercise.Question,
                        })
                }</span>

                <span class="cov8" title="1">td = append(td, &amp;pb.TopicDetails{
                        Id:       int32(topic.ID),
                        Name:     topic.Name,
                        Resource: topic.Resource,
                        ED:       ed,
                })</span>
        }

        <span class="cov8" title="1">cd := pb.CourseDetails{
                Id:      int32(courseDetails.ID),
                Name:    courseDetails.Name,
                Caption: courseDetails.Caption,
                Logo:    courseDetails.Logo,
                Time:    courseDetails.Time,
                TD:      td,
        }

        return &amp;pb.GetAssignedCourseAndMentorDetailsResponse{
                Cd:          &amp;cd,
                MentorEmail: mentor.Email,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) SubmitExercise(ctx context.Context, req *pb.SubmitExerciseRequest) (*pb.SubmitExerciseResponse, error) <span class="cov8" title="1">{

        MenteeEmail := req.Sed.GetMenteeEmail()
        MenteeId, err := s.DB.GetUserIdByEmail(MenteeEmail)

        if err != nil </span><span class="cov8" title="1">{
                return nil, errors.New("Mentee Id not found")
        }</span>

        <span class="cov8" title="1">submit_exercise := models.SubmittedExercises{
                MenteeId:   MenteeId,
                ExerciseId: req.Sed.GetExerciseId(),
                FileName:   req.Sed.GetFileName(),
                File:       req.Sed.GetFile(),
        }

        log.Println("Submit exercise request received")

        id, err := s.DB.SubmitExercise(submit_exercise)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">courseId := 1
        mentee, err := s.DB.GetUserDetails(submit_exercise.MenteeId)
        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">mentor, err := s.DB.GetAssignedMentorDetails(int32(courseId), mentee.Email)
        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>
        
        <span class="cov8" title="1">subject := fmt.Sprintf("New Exercise Submission from %v", mentee.Name)
        content := fmt.Sprintf("Dear %v, I hope this message finds you well. We wanted to inform you that %v has submitted a new exercise.Please take a moment to review the submission and provide feedback to support %v's learning journey. ", mentor.Name, mentee.Name, mentee.Name)

        alerts.SendEmail(mentor.Email, subject, content)

        return &amp;pb.SubmitExerciseResponse{
                Id: id,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) DeleteExercise(ctx context.Context, req *pb.DeleteExerciseRequest) (*pb.DeleteExerciseResponse, error) <span class="cov8" title="1">{

        MenteeEmail := req.GetMenteeEmail()
        ExerciseId := req.GetExerciseId()

        MenteeId, err := s.DB.GetUserIdByEmail(MenteeEmail)

        if err != nil </span><span class="cov8" title="1">{
                return nil, errors.New("Mentee Id not found")
        }</span>

        <span class="cov8" title="1">log.Println("Delete exercise request received")

        res, err := s.DB.DeleteExercise(MenteeId, ExerciseId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">return &amp;pb.DeleteExerciseResponse{
                Message: res,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) GetSubmittedExercise(ctx context.Context, req *pb.GetSubmittedExerciseRequest) (*pb.GetSubmittedExerciseResponse, error) <span class="cov8" title="1">{

        MenteeEmail := req.GetMenteeEmail()
        ExerciseId := req.GetExerciseId()

        MenteeId, err := s.DB.GetUserIdByEmail(MenteeEmail)

        if err != nil </span><span class="cov8" title="1">{
                return nil, errors.New("Mentee Id not found")
        }</span>

        <span class="cov8" title="1">log.Println("Get submitted exercise request received")

        fileName, file, err := s.DB.GetSubmittedExercise(MenteeId, ExerciseId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">return &amp;pb.GetSubmittedExerciseResponse{
                FileName: fileName,
                File:     file,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) GetProgress(ctx context.Context, req *pb.GetProgressRequest) (*pb.GetProgressResponse, error) <span class="cov8" title="1">{

        menteeEmail := req.GetMenteeEmail()
        courseId := req.GetCourseId()

        menteeId, err := s.DB.GetUserIdByEmail(menteeEmail)

        if err != nil </span><span class="cov8" title="1">{
                return nil, errors.New("Mentee Id not found")
        }</span>

        <span class="cov8" title="1">log.Println("Get progress request received")

        res, err := s.DB.GetProgress(menteeId, courseId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">return &amp;pb.GetProgressResponse{
                Progress: res,
        }, nil</span>
}

</pre>
		
		<pre class="file" id="file2" style="display: none">package server

import (
        "context"
        "log"
        pb "lpt/pkg/proto"
)

func (s *LearningPlanTrackerServer) ListAssignedMenteesAndCourses(ctx context.Context, req *pb.ListAssignedMenteesAndCoursesRequest) (*pb.ListAssignedMenteesAndCoursesResponse, error) <span class="cov8" title="1">{

        mentorEmail := req.GetMentorEmail()

        mentorId, err := s.DB.GetUserIdByEmail(mentorEmail)

        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">log.Println("Get assigned mentee and courses request received")

        menteeEmails, menteeIds, courseIds, err := s.DB.ListAssignedMenteesAndCourses(mentorId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">var macd []*pb.MenteeAndCourseDetails

        for i := 0; i &lt; len(menteeEmails); i++ </span><span class="cov8" title="1">{
                macd = append(macd, &amp;pb.MenteeAndCourseDetails{
                        MenteeEmail: menteeEmails[i],
                        MenteeId:    menteeIds[i],
                        CourseId:    courseIds[i],
                })
        }</span>
        <span class="cov8" title="1">return &amp;pb.ListAssignedMenteesAndCoursesResponse{
                Macd: macd,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) ListSubmittedExercisesByMentee(ctx context.Context, req *pb.ListSubmittedExercisesByMenteeRequest) (*pb.ListSubmittedExercisesByMenteeResponse, error) <span class="cov8" title="1">{

        log.Println("Get assigned mentee and courses request received")

        menteeId := req.GetMenteeId()
        courseId := req.GetCourseId()

        submittedExerciseDetails, err := s.DB.ListSubmittedExercisesByMentee(menteeId, courseId)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">var sed []*pb.SubmittedExercisesDetails

        for i := 0; i &lt; len(submittedExerciseDetails); i++ </span><span class="cov8" title="1">{
                sed = append(sed, &amp;pb.SubmittedExercisesDetails{
                        ExerciseId: submittedExerciseDetails[i].ExerciseId,
                        FileName:   submittedExerciseDetails[i].FileName,
                        File:       submittedExerciseDetails[i].File,
                        Question:   submittedExerciseDetails[i].Question,
                })
        }</span>
        <span class="cov8" title="1">return &amp;pb.ListSubmittedExercisesByMenteeResponse{
                SED: sed,
        }, nil</span>
}
</pre>
		
		<pre class="file" id="file3" style="display: none">package server

import (
        "context"
        "fmt"
        "log"
        "lpt/pkg/alerts"
        "lpt/pkg/models"
        pb "lpt/pkg/proto"
)

func (s *LearningPlanTrackerServer) AddUser(ctx context.Context, req *pb.AddUserRequest) (*pb.AddUserResponse, error) <span class="cov8" title="1">{
        u := models.User{
                Name:  req.User.GetName(),
                Email: req.User.GetEmail(),
                Role:  req.User.GetRole(),
        }

        log.Println("Create user request received")

        id, err := s.DB.AddUser(u)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">subject := "Welcome to Learning Plan Tracker!"
        content := fmt.Sprintf("Dear %v\n,We're excited to welcome you to Learning Plan Tracker! Thank you for signing in with name %v and role %v. Happy Learning...", u.Name, u.Name, u.Role)

        alerts.SendEmail(u.Email, subject, content)

        response := pb.User{Id: id, Name: u.Name, Email: u.Email, Role: u.Role}
        return &amp;pb.AddUserResponse{
                User: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) GetUserDetails(ctx context.Context, req *pb.GetUserDetailsRequest) (*pb.GetUserDetailsResponse, error) <span class="cov8" title="1">{
        log.Println("Get user request received")

        id := req.GetId()

        user, err := s.DB.GetUserDetails(id)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">response := pb.User{
                Id:    id,
                Name:  user.Name,
                Email: user.Email,
                Role:  user.Role,
        }

        return &amp;pb.GetUserDetailsResponse{
                User: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) ListUsersByRole(ctx context.Context, req *pb.ListUsersByRoleRequest) (*pb.ListUsersByRoleResponse, error) <span class="cov8" title="1">{
        role := req.GetRole()

        log.Println("List users by role request received")

        res, err := s.DB.ListUsersByRole(int32(role.Number()))

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">return &amp;pb.ListUsersByRoleResponse{
                Name: res,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) CreateAssignment(ctx context.Context, req *pb.CreateAssignmentRequest) (*pb.CreateAssignmentResponse, error) <span class="cov8" title="1">{
        ca := models.CoursesAssigned{
                MentorId: req.Ca.GetMentorId(),
                MenteeId: req.Ca.GetMenteeId(),
                CourseId: req.Ca.GetCourseId(),
        }

        log.Println("Create assiggnment request received")

        id, err := s.DB.CreateAssignment(ca)

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">courseName, err := s.DB.GetCourseNameById(ca.CourseId)
        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">mentor, err := s.DB.GetUserDetails(ca.MentorId)
        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">mentee, err := s.DB.GetUserDetails(ca.MenteeId)
        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">mentorSubject := fmt.Sprintf("Mentee Assignment Notification for %v", courseName)
        mentorContent := fmt.Sprintf("Dear %v\n,I hope this message finds you well. We are pleased to inform you that you have been selected as the mentor for %v in the upcoming %v course. Your expertise and experience make you an ideal mentor for this course, and we believe your guidance will greatly benefit %v.", mentor.Name, mentee.Name, courseName, mentee.Name)

        alerts.SendEmail(mentor.Email, mentorSubject, mentorContent)

        menteeSubject := fmt.Sprintf("Mentor Assignment Notification for %v", courseName)
        menteeContent := fmt.Sprintf("Dear %v\n,We hope this message finds you well. We are excited to inform you that %v has been assigned as your mentor for the upcoming %v course. %v comes highly recommended and brings valuable expertise to guide you through this learning journey.", mentee.Name, mentor.Name, courseName, mentor.Name)

        alerts.SendEmail(mentee.Email, menteeSubject, menteeContent)

        response := pb.CourseAssignment{
                Id:       id,
                MentorId: ca.MentorId,
                MenteeId: ca.MenteeId,
                CourseId: ca.CourseId,
        }
        return &amp;pb.CreateAssignmentResponse{
                Ca: &amp;response,
        }, nil</span>
}

func (s *LearningPlanTrackerServer) ListCurrentAssignments(ctx context.Context, req *pb.ListCurrentAssignmentsRequest) (*pb.ListCurrentAssignmentsResponse, error) <span class="cov8" title="1">{

        log.Println("Get current assignments request received")

        res, err := s.DB.ListCurrentAssignments()

        if err != nil </span><span class="cov8" title="1">{
                log.Println("Error", err.Error())
                return nil, err
        }</span>

        <span class="cov8" title="1">ca := []*pb.CurrentAssignmets{}
        for _, v := range res </span><span class="cov8" title="1">{
                ca = append(ca, &amp;pb.CurrentAssignmets{
                        MentorName: v.Mentor.Name,
                        MenteeName: v.Mentee.Name,
                        CourseName: v.Course.Name,
                })
        }</span>

        <span class="cov8" title="1">return &amp;pb.ListCurrentAssignmentsResponse{
                Ca: ca,
        }, nil</span>
}
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
